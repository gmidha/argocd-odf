apiVersion: batch/v1
kind: Job
metadata:
  name: wait-pod-job
  annotations:
    argocd.argoproj.io/sync-wave: "0"
    compare-options: IgnoreExtraneous
spec:
  ttlSecondsAfterFinished: 4600
  template:
    spec:
      containers:
      - name: wait-pod
        command: ["/bin/sh","-c"]
        args: ["sleep 180 ; oc login https://kubernetes.default.svc.cluster.local --token=$(cat /var/run/secrets/kubernetes.io/serviceaccount/token) --insecure-skip-tls-verify; for i in 'name=ocs-operator' 'app=noobaa' 'app=rook-ceph-operator' ; do oc wait --for condition=Ready pod  --selector=${i} -n openshift-storage --timeout=180s ; sleep 5 ; done"]
        image:  openshift/origin-cli:latest 
      serviceAccount: query-pods
      serviceAccountName: query-pods
      restartPolicy: Never
