{{- range $key, $val := $.Values.apps }}
apiVersion: argoproj.io/v1alpha1
kind: ApplicationSet
metadata:
 name: odf-appset
spec:
 generators:
 - list:
     elements:
{{- range $clus := $.Values.argoclusters }}
     - cluster: {{ $clus }}
       url: {{ $clus }}
{{- end }}
 template:
   metadata:
     name: {{` '{{cluster}}-odf' `}}
   spec:
     project: data-odf
     source:
       helm:
         valueFiles:
           - {{` 'values-{{cluster}}.yaml' `}}
         releaseName: odf-argo
       path: '{{ $val.path }}'
       repoURL: '{{ $.Values.helmRepoUrl }}'
       targetRevision: '{{ $val.branch }}'
     destination:
        name: {{` '{{url}}' `}}
        namespace: openshift-storage
{{- end }}
